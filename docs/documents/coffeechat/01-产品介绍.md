# CoffeeChat

用作者喜欢的一个游戏中的女角色，镇楼：
![Yamato](https://raw.githubusercontent.com/xmcy0011/CoffeeChat/master/images/yamato-sence1.jpg)
![Yamato卡牌](https://raw.githubusercontent.com/xmcy0011/CoffeeChat/master/images/yamato-card.jpg)

```html
为什么起这么个名字？
作者会投入业余时间，来努力完成产品原型的开发（包括server-go，ios-swift），从有这个想法，就一直苦恼产品命名的事情。
3个月过去后，为了能启动项目，就从作者曾经喜欢的事物中选一个好了，这样，这件事情就会变得有趣的多，不是吗？
```

您觉得呢？

## 产品定位

CoffeeChat 的目标是为了丰富独立开发者的工具库，致力于提供免费的高可用高性能高并发（目标：2 台机器、百万用户同时在线、1 秒 1 万条文本）的 IM 解决方案。  
相比于各种云 IMSDK，在您的用户规模较小的时候（百万以下），建议您前期选择 CoffeeChat，后期可以自己定制研发或使用成熟的云 IMSDK 来替换，一般情况，这个空档期在 1-3 年左右。以下是和某云 IMSDK 的对比：

|              |                      | CoffeeChat             | 别人的云 SDK                                                                  |
| ------------ | -------------------- | ---------------------- | ----------------------------------------------------------------------------- |
| 价格         | 基础服务             | 0 元                   | 月功能费： 1800 元(赠送 10000 日活)、超出单价： 超出部分 1000 元/万日活       |
|              | 历史消息存储时长扩展 | 0 元                   | 1500 元/月（历史消息：3 年）                                                  |
|              | 客户端反垃圾         | 0 元                   | 1000 元/月                                                                    |
|              | 合计（3 年）         | 0 元                   | 154,800 元（按照日活 1 万计算）                                               |
| 功能         | 支持客户端           | iOS/Web                | iOS/Android/Windows(PC)/Web                                                   |
|              | 收发消息             | 文字、语音、图片、表情 | 文字、语音、图片、表情、视频、地理位置、文件                                  |
|              | 自定义消息           | ✗                      | 发送骰子、红包、阅后即焚                                                      |
|              | 离线消息             | 所有                   | 用户离线重新上线后收到最近 30 天的未读消息                                    |
|              | 历史消息             | 永久                   | 云端存储最近的历史消息（免费版 30 天，专业版 1 年，专业版可升级拓展）         |
|              | 漫游消息             | ✓                      | ✓ 用户切换到任何设备都可以读取到最近的历史消息                                | ✗ |
|              | 消息抄送             | ✗                      | ✓ 发送的消息内容实时抄送到指定服务器                                          |
|              | 存储空间             | 无限                   | 基础配置存储消息内容（免费版 1T，专业版 1T，专业版可以升级拓展）              |
|              | 文件多重备份         | ✗                      | 云端文件 3 重备份                                                             |
|              | 网络连接状态         | ✗                      | ✓ 开发者可以实时监听网络状态                                                  |
|              | 消息推送提醒         | ✓                      | ✓ 系统通知栏消息提醒                                                          |
|              | 自定义推送内容       | ✗                      | ✓                                                                             |
|              | 黑名单设置           | ✗                      | ✓                                                                             |
|              | 消息转发             | ✗                      | ✓ 可以将接收到的消息转发给其他用户                                            |
|              | @功能                | ✗                      | ✓ 群组中@某人，提醒特别关注消息                                               |
|              | 已读回执             | ✗                      | ✓ 用户发送消息，获取对方是否已读状态                                          |
|              | 多终端已读同步       | ✗                      | ✓ 同个产品多终端情况下，同步消息已读未读的状态                                |
|              | 消息撤回             | ✗                      | ✓ 用户发出的消息，可以在一段时间内将消息撤回                                  |
|              | 正在输入             | ✗                      | ✓ 获取对方输入状态的提醒                                                      |
|              | 免打扰模式           | ✗                      | ✓ 针对整个应用设置不提醒状态                                                  |
|              | 图片压缩             | ✗                      | ✓ 自定义图片压缩比例，保障移动端传输节省流量                                  |
|              | 高清语音消息         | ✗                      | ✓ 语音消息降噪处理                                                            |
|              | 文件上传下载         | ✗                      | ✓ 可以用来发送接收文件                                                        |
|              | 好友关系托管         | ✗                      | ✓ 可以托管好友关系，用户自主选用                                              |
|              | 群最高人数           | 200                    | ✓ 一个群的人数上限默认为 200 人，专业版可升级拓展至 500 人                    |
|              | 创建群数量           | 无限                   | ✓ 免费版一个用户可创建 50 个群组；专业版默认为 100 个，并可升级拓展至 2000 个 |
|              | 群管理权限           | 群主、加人、踢人       | ✓ 群主、管理员、加人、踢人、修改权限                                          |
|              | 自定义群标签         | ✗                      | ✓ 自定义群标签，开发者自主实现对应逻辑                                        |
|              | UI 组件              | ✓ 全部源码             | 免费提供 demo 源码，开发者可以利用源码快速开发                                |
|              | 群消息免打扰         | ✗                      | ✓ 针对一个群可以设置不提醒模式                                                |
| 聊天室       |                      | ✗                      | ✓                                                                             |
| 私有化部署   |                      | ✓                      | ✗                                                                             |
| 数据分析产品 |                      | ✓                      | ✓                                                                             |

CoffeeChat 的优势体现在完全开源免费、可私有化部署，提供核心 IM 基础功能（高频必备）。
后续会围绕独立开发者增加相关工具：

- 教程/文章/源码分析/原理
- 公有云/docker 镜像
- 运维相关（备份、集群部署、监控、负载均衡、主备容灾）
- 测试平台

## 开发计划

为便于研究和推广CoffeeChat，我们会尽量保证每个阶段的成果可用。

### 0.1（原型）：基本架构和基础功能

发布时间：2019.10.30  
版本简介：小而美，初学者建议从该版本入手学习。  
版本定义：
- 双机容灾
- 单聊
- 多媒体消息：文本、表情
- 会话列表

### 0.2：离线消息

- 消息存储
- 历史消息
- 未读消息计数

### 0.3：群聊

- 群聊
- 群管理
- 群成员管理

### 0.4：多端同步、消息漫游

- WebSocket
- 消息漫游
- 多端同步

### 0.5：完整功能

发布时间：2019.12.31  
版本简介：增加更多 im 通用功能，可满足大部分需求。平台保证性能、高可用，iOS 增加机型的适配、消息推送等  
版本定义：
- 百万用户
- 离线消息存储
- 未读消息计数
- 更多多媒体消息：图片、语音、视频

### 1.0：可上生产环境，为独立开发者增加周边工具

发布时间：2020.03.31
版本简介：  
版本定义：
- 生产环境
- 集群
- 监控
- 数据分析
- 自动备份